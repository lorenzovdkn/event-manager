<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}EventManager{% endblock %}</title>

    {# Bootstrap 5 CSS (CDN) #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    {# Bootstrap Icons #}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <style>
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: #f8f9fa;
        }
        main {
            flex: 1;
            padding-top: 2rem;
            padding-bottom: 3rem;
        }
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            box-shadow: 0 2px 4px rgba(0,0,0,.1);
        }
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: white !important;
        }
        .navbar .nav-link {
            color: rgba(255,255,255,0.9) !important;
            font-weight: 500;
            transition: color 0.3s;
        }
        .navbar .nav-link:hover {
            color: white !important;
        }
        .navbar .btn-outline-light {
            border-color: white;
            color: white;
        }
        .navbar .btn-outline-light:hover {
            background-color: white;
            color: #667eea;
        }
        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,.1);
            transition: transform 0.3s, box-shadow 0.3s;
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 16px rgba(0,0,0,.15);
        }
        .card-img-top {
            border-radius: 0;
        }
        .btn {
            border-radius: 8px;
            font-weight: 500;
            padding: 0.5rem 1.25rem;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102,126,234,.4);
        }
        footer {
            background-color: #fff;
            border-top: 1px solid #dee2e6;
            margin-top: auto;
            padding: 2rem 0;
        }
        .page-header {
            margin-bottom: 2rem;
        }
        .page-header h1 {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 0.5rem;
        }
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102,126,234,.25);
        }
        .badge {
            padding: 0.5rem 0.75rem;
            font-weight: 500;
        }
    </style>

    {% block stylesheets %}{% endblock %}
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark">
  <div class="container">
    <a class="navbar-brand" href="{{ path('app_home') }}">
        <i class="bi bi-calendar-event me-2"></i>EventManager
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="mainNavbar">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="{{ path('app_home') }}"><i class="bi bi-house-door me-1"></i>Accueil</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ path('app_events') }}"><i class="bi bi-grid me-1"></i>Événements</a></li>

        {% if is_granted('IS_AUTHENTICATED_FULLY') %}
          <li class="nav-item"><a class="nav-link" href="{{ path('app_my_events') }}"><i class="bi bi-bookmark me-1"></i>Mes événements</a></li>
          <li class="nav-item"><a class="nav-link" href="{{ path('app_my_inscriptions') }}"><i class="bi bi-ticket-perforated me-1"></i>Mes inscriptions</a></li>
          <li class="nav-item"><a class="nav-link" href="{{ path('app_event_new') }}"><i class="bi bi-plus-circle me-1"></i>Créer</a></li>
        {% endif %}
      </ul>

      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        {% if app.user %}
          <li class="nav-item d-flex align-items-center me-3">
            <span class="text-white"><i class="bi bi-person-circle me-2"></i>{{ app.user.name ?: app.user.email }}</span>
          </li>
          <li class="nav-item">
            <form method="post" action="{{ path('app_logout') }}" class="d-inline">
              <input type="hidden" name="_csrf_token" value="{{ csrf_token('logout') }}">
              <button class="btn btn-outline-light btn-sm" type="submit"><i class="bi bi-box-arrow-right me-1"></i>Déconnexion</button>
            </form>
          </li>
        {% else %}
          <li class="nav-item"><a class="nav-link" href="{{ path('app_login') }}"><i class="bi bi-box-arrow-in-right me-1"></i>Connexion</a></li>
          <li class="nav-item ms-2"><a class="btn btn-outline-light btn-sm" href="{{ path('app_register') }}"><i class="bi bi-person-plus me-1"></i>Inscription</a></li>
        {% endif %}
      </ul>
    </div>
  </div>
</nav>

<main class="container">
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endfor %}
    
    {% block body %}{% endblock %}
</main>

<footer class="text-center">
    <div class="container">
        <p class="text-muted mb-0">
            <i class="bi bi-calendar-event me-2"></i>
            <strong>EventManager</strong> - Gérez vos événements facilement
        </p>
        <small class="text-muted">© {{ 'now'|date('Y') }} EventManager. Tous droits réservés.</small>
    </div>
</footer>

{# Bootstrap JS bundle (incl. Popper) #}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
{% block javascripts %}{% endblock %}

</body>
</html>